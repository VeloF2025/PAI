{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PAI Pack Manifest",
  "description": "Pack v2.0 manifest for dependency management, versioning, and metadata",
  "type": "object",
  "required": ["name", "version"],
  "properties": {
    "name": {
      "type": "string",
      "description": "Pack name (must match directory name)",
      "pattern": "^[a-z0-9-]+$",
      "examples": ["agent-observability", "kai", "fabric"]
    },
    "version": {
      "type": "string",
      "description": "Semantic version (semver 2.0.0)",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
      "examples": ["1.0.0", "2.1.3", "1.0.0-beta.1"]
    },
    "description": {
      "type": "string",
      "description": "Short description of pack functionality",
      "maxLength": 200
    },
    "author": {
      "type": "string",
      "description": "Pack author name or organization",
      "examples": ["PAI", "Dan Miessler", "Community"]
    },
    "license": {
      "type": "string",
      "description": "SPDX license identifier",
      "examples": ["MIT", "Apache-2.0", "GPL-3.0"],
      "default": "MIT"
    },
    "category": {
      "type": "string",
      "description": "Pack category for organization",
      "enum": ["automation", "development", "observability", "validation", "research", "integration", "security"],
      "examples": ["automation"]
    },
    "keywords": {
      "type": "array",
      "description": "Keywords for pack discovery",
      "items": {
        "type": "string"
      },
      "examples": [["hooks", "monitoring", "real-time"]]
    },
    "homepage": {
      "type": "string",
      "format": "uri",
      "description": "Pack documentation URL"
    },
    "repository": {
      "type": "object",
      "description": "Source code repository",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["git"],
          "default": "git"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "examples": ["https://github.com/Heinvv10/PAI.git"]
        }
      },
      "required": ["url"]
    },
    "dependencies": {
      "type": "object",
      "description": "Required packs that must be installed first",
      "additionalProperties": {
        "type": "string",
        "pattern": "^(\\^|~|>=?|<=?|=)?\\s*(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)",
        "examples": ["^1.0.0", "~2.1.0", ">=1.5.0", "2.0.0"]
      },
      "examples": [
        {
          "kai": "^2.0.0",
          "agent-observability": "^1.0.0"
        }
      ]
    },
    "peerDependencies": {
      "type": "object",
      "description": "Expected environment dependencies (not auto-installed)",
      "additionalProperties": {
        "type": "string"
      },
      "examples": [
        {
          "claude-code": "^1.0.0",
          "bun": "^1.0.0"
        }
      ]
    },
    "devDependencies": {
      "type": "object",
      "description": "Dependencies only needed for development/testing",
      "additionalProperties": {
        "type": "string"
      }
    },
    "optionalDependencies": {
      "type": "object",
      "description": "Optional packs that enhance functionality but aren't required",
      "additionalProperties": {
        "type": "string"
      },
      "examples": [
        {
          "voice": "^1.0.0"
        }
      ]
    },
    "provides": {
      "type": "object",
      "description": "What this pack provides to other packs",
      "properties": {
        "hooks": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "examples": [["session-start.ts", "stop-hook.ts"]]
        },
        "skills": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "tools": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "mcps": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "utilities": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "examples": [["event-bus.ts", "shared.ts", "security.ts"]]
        }
      }
    },
    "conflicts": {
      "type": "object",
      "description": "Packs that cannot be installed alongside this one",
      "additionalProperties": {
        "type": "string"
      },
      "examples": [
        {
          "old-kai": "*",
          "legacy-hooks": "*"
        }
      ]
    },
    "engines": {
      "type": "object",
      "description": "Runtime version requirements",
      "properties": {
        "bun": {
          "type": "string",
          "examples": [">=1.0.0"]
        },
        "node": {
          "type": "string",
          "examples": [">=18.0.0"]
        },
        "claude-code": {
          "type": "string",
          "examples": [">=1.0.0"]
        }
      }
    },
    "os": {
      "type": "array",
      "description": "Supported operating systems",
      "items": {
        "type": "string",
        "enum": ["linux", "darwin", "win32"]
      },
      "examples": [["linux", "darwin", "win32"]]
    },
    "scripts": {
      "type": "object",
      "description": "Lifecycle scripts for installation, testing, etc.",
      "properties": {
        "preinstall": {
          "type": "string",
          "description": "Script to run before installation"
        },
        "install": {
          "type": "string",
          "description": "Custom installation script"
        },
        "postinstall": {
          "type": "string",
          "description": "Script to run after installation"
        },
        "test": {
          "type": "string",
          "description": "Test suite command"
        },
        "verify": {
          "type": "string",
          "description": "Verification command"
        },
        "uninstall": {
          "type": "string",
          "description": "Cleanup script for uninstallation"
        }
      }
    },
    "config": {
      "type": "object",
      "description": "Pack-specific configuration options",
      "additionalProperties": true
    },
    "files": {
      "type": "array",
      "description": "Files to include in pack distribution",
      "items": {
        "type": "string"
      },
      "examples": [["src/**/*", "README.md", "INSTALL.md", "VERIFY.md"]]
    }
  }
}
